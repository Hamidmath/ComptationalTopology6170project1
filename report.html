<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Topological Shape Analysis - Comprehensive Report</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }

        h1,
        h2,
        h3,
        h4 {
            color: #2c3e50;
        }

        .section {
            background: #fdfdfd;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .pipeline-step {
            background: #f4f8fa;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #2ecc71;
            border-radius: 4px;
        }

        .script-title {
            font-weight: bold;
            font-family: monospace;
            color: #d35400;
            font-size: 1.1em;
        }

        .details-list {
            list-style-type: none;
            padding-left: 0;
        }

        .details-list li {
            margin-bottom: 5px;
        }

        .tag-read {
            display: inline-block;
            background: #e0f7fa;
            color: #006064;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: bold;
            width: 60px;
            text-align: center;
            margin-right: 10px;
        }

        .tag-write {
            display: inline-block;
            background: #fce4ec;
            color: #880e4f;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: bold;
            width: 60px;
            text-align: center;
            margin-right: 10px;
        }

        .tag-desc {
            display: inline-block;
            background: #fff3e0;
            color: #e65100;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: bold;
            width: 60px;
            text-align: center;
            margin-right: 10px;
        }

        code {
            background: #f1f1f1;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
        }

        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .image-card {
            text-align: center;
            background: white;
            padding: 15px;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .image-card img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
            border: 1px solid #eee;
        }

        .metric-box {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 4px solid #3498db;
        }
    </style>
</head>

<body>

    <h1>Topological Shape Analysis - Comprehensive Project Report</h1>

    <div class="section">
        <h2>1. Project Pipeline & File Dependencies</h2>
        <p>The following details the execution order of the scripts, showing precisely which files act as inputs and
            which files are generated by each code component.</p>

        <div class="pipeline-step">
            <h3>Step 1: Data Preparation</h3>
            <p><span class="script-title">make_manifest.py</span></p>
            <ul class="details-list">
                <li><span class="tag-read">READS</span> Raw image files (<code>.gif</code>) from the
                    <code>SelectedSubset/</code> directory.
                </li>
                <li><span class="tag-write">WRITES</span> A manifest file list to <code>data/selected_files.txt</code>.
                </li>
                <li><span class="tag-desc">DESC</span> Scans the image dataset and creates a consistent list of selected
                    files mapped to their object classes.</li>
            </ul>
        </div>

        <div class="pipeline-step">
            <h3>Step 2: Boundary Extraction</h3>
            <p><span class="script-title">extract_all_boundaries.py</span></p>
            <ul class="details-list">
                <li><span class="tag-read">READS</span> The manifest from <code>data/selected_files.txt</code> and
                    images from <code>SelectedSubset/</code>.</li>
                <li><span class="tag-write">WRITES</span> <code>(x, y)</code> coordinate boundary arrays to the
                    <code>txtfiles/</code> directory (<code>*_points.txt</code>).
                </li>
                <li><span class="tag-desc">DESC</span> Binarizes each shape image, extracts the outermost contour
                    boundary, and saves the 2D point cloud.</li>
            </ul>
            <p><span class="script-title">draw_boundary.py</span></p>
            <ul class="details-list">
                <li><span class="tag-read">READS</span> A specific boundary file from <code>txtfiles/</code>.</li>
                <li><span class="tag-desc">DESC</span> A simple utility to visualize a 2D point cloud boundary of a
                    single shape to verify successful extraction.</li>
            </ul>
        </div>

        <div class="pipeline-step">
            <h3>Step 3: Persistent Homology Computation</h3>
            <p><span class="script-title">compute_all_barcodes.py</span></p>
            <ul class="details-list">
                <li><span class="tag-read">READS</span> Boundary coordinate files from <code>txtfiles/</code>
                    (<code>*_points.txt</code>).</li>
                <li><span class="tag-write">WRITES</span> Topological barcodes (H0 and H1 components) to the
                    <code>barcodes/</code> directory (<code>*_H0.txt</code> and <code>*_H1.txt</code>).
                </li>
                <li><span class="tag-desc">DESC</span> Runs the <code>ripser</code> library on the point clouds to
                    compute their persistent homology up to dimension 1.</li>
            </ul>
            <p><span class="script-title">draw_ripser_barcodes.py</span></p>
            <ul class="details-list">
                <li><span class="tag-read">READS</span> A set of barcode files for a specific shape from
                    <code>barcodes/</code>.
                </li>
                <li><span class="tag-desc">DESC</span> Visualization utility to plot the H0 and H1 persistence diagrams
                    for a single shape.</li>
            </ul>
        </div>

        <div class="pipeline-step">
            <h3>Step 4: Distance Computation</h3>
            <p><span class="script-title">compute_H.py</span></p>
            <ul class="details-list">
                <li><span class="tag-read">READS</span> H0 or H1 barcodes respectively from the <code>barcodes/</code>
                    directory.</li>
                <li><span class="tag-write">WRITES</span> Bottleneck or Wasserstein distance matrices and file orders to
                    the
                    <code>data/</code> directory (e.g., <code>dist_H0_bottleneck.npy</code>,
                    <code>H0_bottleneck_file_order.npy</code>).
                </li>
                <li><span class="tag-desc">DESC</span> A unified script that computes pairwise topological distances
                    based on the selected mode (e.g., <code>--mode h0b</code> for H0 Bottleneck, <code>--mode h1w</code>
                    for H1 Wasserstein).</li>
            </ul>
        </div>

        <div class="pipeline-step">
            <h3>Step 5: Embedding & Visualization</h3>
            <p><span class="script-title">raw_image_baseline.py</span></p>
            <ul class="details-list">
                <li><span class="tag-read">READS</span> Raw image files from <code>SelectedSubset/</code>.</li>
                <li><span class="tag-write">WRITES</span> Euclidean distance baseline matrix
                    (<code>data/dist_raw_euclidean.npy</code>) and baseline MDS/t-SNE plots
                    (<code>data/mds_raw_images.png</code>, <code>data/tsne_raw_images.png</code>).</li>
                <li><span class="tag-desc">DESC</span> Evaluates a non-topological baseline by computing Euclidean
                    distances between flattened raw pixels and visualizing the embeddings.</li>
            </ul>
            <p><span class="script-title">mds_H.py</span></p>
            <ul class="details-list">
                <li><span class="tag-read">READS</span> Pre-computed distance matrices and file orders from the
                    <code>data/</code> directory.
                </li>
                <li><span class="tag-write">WRITES</span> 2D MDS scatter plot images to the <code>data/</code> directory
                    (e.g., <code>mds_H0_bottleneck.png</code>).</li>
                <li><span class="tag-desc">DESC</span> Applies Multi-Dimensional Scaling (MDS) to layout the shapes
                    based on their topological distances. Uses the <code>--mode</code> flag to select the correct
                    distance matrix.</li>
            </ul>
            <p><span class="script-title">tsne_from_distance.py</span></p>
            <ul class="details-list">
                <li><span class="tag-read">READS</span> A specific topological distance matrix from the
                    <code>data/</code> directory.
                </li>
                <li><span class="tag-write">WRITES</span> 2D t-SNE scatter plot images to the <code>data/</code>
                    directory (e.g., <code>tsne_H0_bottleneck.png</code>).</li>
                <li><span class="tag-desc">DESC</span> Applies t-SNE for an alternative clustering visualization of the
                    distance matrix. Uses the <code>--mode</code> flag to select the correct distance matrix.</li>
            </ul>
        </div>

        <div class="pipeline-step">
            <h3>Step 6: Baselines & Machine Learning</h3>
            <p><span class="script-title">svm_persistence_images.py</span></p>
            <ul class="details-list">
                <li><span class="tag-read">READS</span> H1 barcodes from the <code>barcodes/</code> directory.</li>
                <li><span class="tag-desc">DESC</span> Converts persistence diagrams into grid-based Persistence Images
                    and trains an SVM classifier to predict shape categories.</li>
            </ul>
            <p><span class="script-title">kernel_svm_persistence_scale_space.py</span></p>
            <ul class="details-list">
                <li><span class="tag-read">READS</span> H1 barcodes from the <code>barcodes/</code> directory.</li>
                <li><span class="tag-write">WRITES</span> Computed Persistence Scale Space kernels, class labels, and
                    file lists to the <code>results_kernel/</code> directory.</li>
                <li><span class="tag-desc">DESC</span> Computes topological kernel matrices directly from barcodes and
                    trains an SVM. Saves the kernels for further analysis.</li>
            </ul>
            <p><span class="script-title">kernel_rep.py</span></p>
            <ul class="details-list">
                <li><span class="tag-read">READS</span> Kernel matrices (<code>K_*.npy</code>) and label/file data from
                    the <code>results_kernel/</code> directory.</li>
                <li><span class="tag-desc">DESC</span> An analysis script that verifies matrix structures, min/max
                    values, and class distributions for the generated kernels.</li>
            </ul>
        </div>
    </div>

    <div class="section">
        <h2>2. Embeddings & Visualizations</h2>
        <p>Below are the resulting MDS and t-SNE projections from the generated distance matrices. These confirm the
            structural similarities captured by raw pixels vs. topological features.</p>

        <h3>2.1 Baseline: Raw Images (Euclidean Distance on Pixels)</h3>
        <div class="image-grid">
            <div class="image-card">
                <h4>MDS Projection</h4>
                <img src="data/mds_raw_images.png" alt="MDS Raw Images">
            </div>
            <div class="image-card">
                <h4>t-SNE Projection</h4>
                <img src="data/tsne_raw_images.png" alt="t-SNE Raw Images">
            </div>
        </div>

        <h3>2.2 Topology: H0 Features (Connected Components)</h3>
        <h4>Bottleneck Distance</h4>
        <div class="image-grid">
            <div class="image-card">
                <h4>MDS Projection</h4>
                <img src="data/mds_H0_bottleneck.png" alt="MDS H0 Bottleneck">
            </div>
            <div class="image-card">
                <h4>t-SNE Projection</h4>
                <img src="data/tsne_H0_bottleneck.png" alt="t-SNE H0 Bottleneck">
            </div>
        </div>

        <h4>Wasserstein Distance</h4>
        <div class="image-grid">
            <div class="image-card">
                <h4>MDS Projection</h4>
                <img src="data/mds_H0_wasserstein.png" alt="MDS H0 Wasserstein">
            </div>
            <div class="image-card">
                <h4>t-SNE Projection</h4>
                <img src="data/tsne_H0_wasserstein.png" alt="t-SNE H0 Wasserstein">
            </div>
        </div>

        <h3>2.3 Topology: H1 Features (1-Dimensional Holes)</h3>
        <h4>Bottleneck Distance</h4>
        <div class="image-grid">
            <div class="image-card">
                <h4>MDS Projection</h4>
                <img src="data/mds_H1_bottleneck.png" alt="MDS H1 Bottleneck">
            </div>
            <div class="image-card">
                <h4>t-SNE Projection</h4>
                <img src="data/tsne_H1_bottleneck.png" alt="t-SNE H1 Bottleneck">
            </div>
        </div>

        <h4>Wasserstein Distance</h4>
        <div class="image-grid">
            <div class="image-card">
                <h4>MDS Projection</h4>
                <img src="data/mds_H1_wasserstein.png" alt="MDS H1 Wasserstein">
            </div>
            <div class="image-card">
                <h4>t-SNE Projection</h4>
                <img src="data/tsne_H1_wasserstein.png" alt="t-SNE H1 Wasserstein">
            </div>
        </div>

        <h3>Comparison Analysis</h3>
        <p>Visual inspection of the embeddings reveals distinct behaviors across the different distance metrics and
            projection techniques:</p>
        <ul>
            <li><strong>Baseline (Raw Images):</strong> Surprisingly, the raw pixel-wise Euclidean distance produced
                recognizable clustering, with raw t-SNE showing better visual separation of classes than MDS.</li>
            <li><strong>H0 Features (Connected Components):</strong> The Bottleneck distance spread the points uniformly
                in the MDS projection, while its t-SNE counterpart packed everything too closely, making it difficult to
                recognize meaningful clustering in either. The Wasserstein distance for H0 showed slight improvements
                over Bottleneck but remained ambiguous.</li>
            <li><strong>H1 Features (1-Dimensional Holes):</strong> The Bottleneck distance for H1 yielded no meaningful
                visual clusters in neither MDS nor t-SNE. Conversely, the H1 Wasserstein distance showed the most
                promise among topological methods, with some clusters becoming weakly recognizable in both MDS and t-SNE
                projections.</li>
        </ul>
    </div>

    <div class="section">
        <h2>3. Classification Results (Support Vector Machines)</h2>
        <p>To formally evaluate the discriminative power of the topological features, we trained Support Vector Machines
            (SVM) on the persistence diagrams. We evaluated the performance on two subsets of the data: a simpler
            4-class problem and a more complex 8-class problem. Two different vectorization/kernel approaches were used.
        </p>

        <div class="metric-box">
            <h3>1. Persistence Images (Grid Feature Vectors)</h3>
            <p>Converting the diagrams into fixed-size grid matrices allows for standard linear SVM classification, but
                resulted in poor accuracy due to the loss of exact spatial geometry and sparse information distribution
                across the high-dimensional feature space. (Note: Accuracies below are based on normalized point-cloud
                boundaries)</p>
            <ul style="margin: 5px 0 0 20px;">
                <li><strong>4-Class Accuracy:</strong> 50.0%</li>
                <li><strong>8-Class Accuracy:</strong> 37.5%</li>
            </ul>
        </div>

        <div class="metric-box">
            <h3>2. Persistence Scale Space Kernel (Direct Diagram Comparison)</h3>
            <p>Using a computed topological Gram matrix directly as a Custom SVM kernel bypasses grid approximation and
                computes exact mathematical similarities
                between the born/die cycles of the shapes across scale spaces. With the inclusion of
                diagonal-normalization, this method yielded identical predictive power to the Persistence Image
                approach.</p>
            <ul style="margin: 5px 0 0 20px;">
                <li><strong>4-Class Accuracy:</strong> 50.0%</li>
                <li><strong>8-Class Accuracy:</strong> 37.5%</li>
            </ul>
        </div>

        <h3>Interpretation of Accuracies</h3>
        <p>After re-running the entire pipeline with <strong>Diagonal Normalization</strong> (ensuring scale-invariance
            for the boundaries), both models equalized in their performance: achieving 50.0% on the 4-class problem, and
            37.5% on the 8-class problem. This normalization step successfully removed the bias of absolute size from
            the structural comparison.</p>
        <p>The consistent drop in performance from the 4-class subset to the 8-class subset indicates that while the
            topological
            signatures can reasonably separate distinctly different simple shapes (like <code>cup</code> and
            <code>device8</code>),
            adding more classes introduces shapes with overlapping topological properties (e.g., similar numbers of
            loops with similar lifespans), making the classification boundary more difficult to resolve definitively.
        </p>
    </div>

</body>

</html>